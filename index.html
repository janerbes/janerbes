<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ‰ Admin-only Website ğŸ‰</title>

<!-- Supabase JS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family:'Comic Sans MS', cursive, sans-serif;
    background: linear-gradient(45deg,#ff6b6b,#4ecdc4,#45b7d1,#96ceb4,#ffeaa7);
    background-size:300% 300%; animation:rainbowBg 8s ease infinite;
    min-height:100vh; overflow-x:hidden;
}
@keyframes rainbowBg {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
.container { max-width:1200px; margin:0 auto; padding:20px; }
.header { text-align:center; margin-bottom:30px; background:rgba(255,255,255,0.9); border-radius:20px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,0.2); animation:bounce 2s infinite; }
@keyframes bounce { 0%,20%,50%,80%,100%{transform:translateY(0);}40%{transform:translateY(-10px);}60%{transform:translateY(-5px);} }
.header h1 { font-size:3rem; color:#2c3e50; text-shadow:3px 3px 6px rgba(0,0,0,0.3); margin-bottom:10px; }
.date { font-size:1.5rem; color:#e74c3c; font-weight:bold; }
.status { background: rgba(46,204,113,0.9); color:white; padding:10px; border-radius:10px; margin:10px 0; text-align:center; font-weight:bold; }
.status.offline { background: rgba(231,76,60,0.9); }
.controls { background: rgba(255,255,255,0.95); border-radius:15px; padding:20px; margin-bottom:20px; box-shadow:0 5px 15px rgba(0,0,0,0.1); }
.control-group { margin-bottom:15px; }
.control-group label { display:block; margin-bottom:5px; font-weight:bold; color:#2c3e50; }
input, textarea, button, select { width:100%; padding:10px; border:2px solid #3498db; border-radius:10px; font-size:1rem; transition:all 0.3s ease; }
input:focus, textarea:focus, select:focus { outline:none; border-color:#e74c3c; transform:scale(1.02); }
button { background: linear-gradient(45deg,#e74c3c,#f39c12); color:white; border:none; cursor:pointer; font-weight:bold; text-transform:uppercase; letter-spacing:1px; }
button:hover { transform:scale(1.05); box-shadow:0 5px 15px rgba(0,0,0,0.3); }
button:disabled { background:#95a5a6; cursor:not-allowed; transform:none; }
.content-area { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; margin-top:20px; }
.content-item { background: rgba(255,255,255,0.95); border-radius:15px; padding:20px; box-shadow:0 10px 25px rgba(0,0,0,0.1); transition:all 0.3s ease; position:relative; overflow:hidden; opacity:0; transform:translateY(20px); }
.content-item.loaded { opacity:1; transform:translateY(0); }
.post-meta { font-size:0.8rem; color:#7f8c8d; margin-bottom:10px; border-bottom:1px solid #ecf0f1; padding-bottom:5px; }
.post-title { font-size:1.2rem; font-weight:bold; color:#2c3e50; margin-bottom:10px; }
.post-text { line-height:1.6; margin:10px 0; padding:10px; border-radius:10px; background: rgba(255,255,255,0.5); }
.image-container { text-align:center; margin:15px 0; position:relative; }
.image-container img { max-width:100%; max-height:300px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.2); transition:all 0.3s ease; cursor:pointer; }
.floating-elements { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:-1; }
.floating-emoji { position:absolute; font-size:2rem; animation:float 6s ease-in-out infinite; opacity:0.7; }
@keyframes float {0%,100%{transform:translateY(0) rotate(0deg);}50%{transform:translateY(-20px) rotate(180deg);} }
.fun-facts { background: rgba(255,255,255,0.9); border-radius:15px; padding:15px; margin:20px 0; border-left:5px solid #f39c12; }
.color-picker-container { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.color-option { width:40px; height:40px; border-radius:50%; border:3px solid #fff; cursor:pointer; transition:all 0.3s ease; }
.color-option:hover, .color-option.selected { transform:scale(1.2); border-color:#2c3e50; }
.stats { display:flex; justify-content:space-around; background: rgba(255,255,255,0.9); border-radius:15px; padding:15px; margin:20px 0; }
.stat-item { text-align:center; }
.stat-number { font-size:2rem; font-weight:bold; color:#e74c3c; }
.refresh-btn { background: linear-gradient(45deg,#3498db,#2980b9) !important; width:auto !important; padding:10px 20px !important; margin:10px 5px !important; }
.notification { position:fixed; top:20px; right:20px; background:#2ecc71; color:white; padding:15px 20px; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.3); z-index:1000; animation:slideIn 0.5s ease; }
@keyframes slideIn { from{transform:translateX(100%) translateY(0); opacity:0;} to{transform:translateX(0); opacity:1;} }
.loading { text-align:center; padding:20px; font-size:1.2rem; color:#3498db; }
.loading:after { content:'...'; animation:loading-dots 1.5s infinite; }
@keyframes loading-dots {0%,20%{color:transparent;}40%{color:#3498db;}100%{color:transparent;} }
@media(max-width:768px) {.header h1{font-size:2rem;} .content-area{grid-template-columns:1fr;} .stats{flex-direction:column; gap:10px;} }
</style>
</head>
<body>
<div class="floating-elements" id="floatingElements"></div>

<div class="container">
<div class="header">
<h1>ğŸ‰ Admin-only Website ğŸ‰</h1>
<div class="date" id="currentDate"></div>
<div class="status" id="connectionStatus">ğŸŒ Nur Admin kann posten</div>
</div>

<div class="controls">

<div class="control-group" id="loginGroup">
<label>ğŸ”‘ Admin-Login:</label>
<input type="email" id="loginEmail" placeholder="E-Mail">
<input type="password" id="loginPassword" placeholder="Passwort">
<button onclick="loginAdmin()">Login</button>
</div>

<div id="postControls" style="display:none;">
<div class="control-group">
<label>ğŸ“ Titel fÃ¼r deinen Beitrag:</label>
<input type="text" id="titel" placeholder="Witziger Titel...">
</div>
<div class="control-group">
<label>ğŸ–¼ï¸ Bild/GIF URL:</label>
<input type="text" id="imageUrl" placeholder="https://giphy.com/... oder andere Bild-URL">
</div>
<div class="control-group">
<label>ğŸ“ Lustiger Text:</label>
<textarea id="newText" placeholder="Schreibe hier etwas Lustiges..." rows="3"></textarea>
</div>
<div class="control-group">
<label>ğŸ¨ Textfarbe wÃ¤hlen:</label>
<div class="color-picker-container">
<div class="color-option selected" style="background-color:#e74c3c" data-color="#e74c3c"></div>
<div class="color-option" style="background-color:#3498db" data-color="#3498db"></div>
<div class="color-option" style="background-color:#2ecc71" data-color="#2ecc71"></div>
<div class="color-option" style="background-color:#f39c12" data-color="#f39c12"></div>
</div>
</div>
<button onclick="addContent()" id="addBtn">âœ¨ Beitrag verÃ¶ffentlichen âœ¨</button>
<button onclick="loadContent()" class="refresh-btn">ğŸ”„ Aktualisieren</button>
</div>
</div>

<div class="fun-facts">
<strong>ğŸ’¡ Hinweis:</strong> Nur Admin kann BeitrÃ¤ge posten!
</div>

<div class="loading" id="loadingIndicator">Lade BeitrÃ¤ge</div>
<div class="content-area" id="contentArea"></div>
</div>

<script>
const SUPABASE_URL = 'https://xldpbrvskuxhgcbxibgq.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

let selectedColor='#e74c3c';
let realtimeChannel=null;
let currentUser=null;

function updateDate(){
const now=new Date();
const options={weekday:'long',year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'};
document.getElementById('currentDate').textContent=now.toLocaleDateString('de-DE',options);
}

function createFloatingEmojis(){
const emojis=['ğŸ˜‚','ğŸ¤£','ğŸ˜Š','ğŸ‰','ğŸŒŸ','âœ¨','ğŸˆ','ğŸŠ','ğŸ­','ğŸª','ğŸ’«','ğŸ¨'];
const container=document.getElementById('floatingElements');
for(let i=0;i<20;i++){
const emoji=document.createElement('div');
emoji.className='floating-emoji';
emoji.textContent=emojis[Math.floor(Math.random()*emojis.length)];
emoji.style.left=Math.random()*100+'%';
emoji.style.top=Math.random()*100+'%';
emoji.style.animationDelay=Math.random()*6+'s';
emoji.style.animationDuration=(Math.random()*4+4)+'s';
container.appendChild(emoji);}
}

async function loginAdmin(){
const email=document.getElementById('loginEmail').value;
const password=document.getElementById('loginPassword').value;
const { data, error }=await supabase.auth.signInWithPassword({email,password});
if(error){alert('âŒ Login fehlgeschlagen: '+error.message);}
else{
currentUser=data.user;
alert('âœ… Login erfolgreich!');
document.getElementById('loginGroup').style.display='none';
document.getElementById('postControls').style.display='block';
updateStatus('ğŸŒ Verbunden als Admin');
}
}

function updateStatus(message,isOnline=true){
const statusElement=document.getElementById('connectionStatus');
statusElement.textContent=message;
statusElement.className=isOnline?'status':'status offline';
}

async function loadContent(){
document.getElementById('loadingIndicator').style.display='block';
try{
const {data,error}=await supabase.from('lustige_inhalte').select('*').order('created_at',{ascending:false});
if(error){console.error(error); updateStatus('âŒ Fehler beim Laden',false); return;}
displayContent(data);
updateStatus(currentUser?'ğŸŒ Verbunden als Admin':'ğŸŒ Nur Admin kann posten');
}catch(e){console.error(e); updateStatus('âŒ Fehler',false);}
finally{document.getElementById('loadingIndicator').style.display='none';}
}

function displayContent(data){
const contentArea=document.getElementById('contentArea');
contentArea.innerHTML='';
if(data.length===0){contentArea.innerHTML='<div class="content-item loaded" style="grid-column:1/-1;text-align:center;"><h3>ğŸ­ Noch keine BeitrÃ¤ge!</h3></div>'; return;}
data.forEach((item,index)=>{
const contentItem=document.createElement('div');
contentItem.className='content-item';
const dateFormatted=new Date(item.created_at).toLocaleString('de-DE',{day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit'});
contentItem.innerHTML=`<div class="post-meta">ğŸ‘¤ ${item.autor||'Admin'} â€¢ ğŸ“… ${dateFormatted}</div>
${item.titel?`<div class="post-title">${item.titel}</div>`:''}
${item.bild_url?`<div class="image-container"><img src="${item.bild_url}" alt="Bild" onerror="this.style.display='none'; this.parentElement.innerHTML='ğŸ–¼ï¸ Bild konnte nicht geladen werden';"></div>`:''}
${item.inhalt_text?`<div class="post-text" style="color:${item.text_farbe||'#2c3e50'}">${item.inhalt_text}</div>`:''}`;
contentArea.appendChild(contentItem);
setTimeout(()=>{contentItem.classList.add('loaded');},index*100);
});
}

async function addContent(){
if(!currentUser){alert('âŒ Du musst eingeloggt sein!'); return;}
const titel=document.getElementById('titel').value.trim();
const inhaltText=document.getElementById('newText').value.trim();
const bildUrl=document.getElementById('imageUrl').value.trim();
if(!titel&&!inhaltText&&!bildUrl){alert('Bitte Titel, Text oder Bild hinzufÃ¼gen!'); return;}
const addBtn=document.getElementById('addBtn'); addBtn.disabled=true; addBtn.textContent='ğŸ’¾ VerÃ¶ffentliche...';
try{
const {error}=await supabase.from('lustige_inhalte').insert([{titel:titel||null,inhalt_text:inhaltText||null,bild_url:bildUrl||null,text_farbe:selectedColor,autor:'Admin'}]);
if(error){alert('âŒ Fehler beim Speichern!'); console.error(error);}
else{
document.getElementById('titel').value=''; document.getElementById('newText').value=''; document.getElementById('imageUrl').value='';
alert('ğŸ‰ Beitrag verÃ¶ffentlicht!');
}
}finally{addBtn.disabled=false; addBtn.textContent='âœ¨ Beitrag verÃ¶ffentlichen âœ¨';}
}

function setupColorPicker(){
document.querySelectorAll('.color-option').forEach(opt=>{
opt.addEventListener('click',function(){
selectedColor=this.dataset.color;
document.querySelectorAll('.color-option').forEach(o=>o.classList.remove('selected'));
this.classList.add('selected');
});
});
}

window.onload=function(){
updateDate(); createFloatingEmojis(); setupColorPicker(); loadContent();
setupRealtime(); setInterval(updateDate,60000);
};

function setupRealtime(){
realtimeChannel=supabase.channel('lustige_inhalte_changes').on('postgres_changes',{event:'*',schema:'public',table:'lustige_inhalte'},payload=>{
loadContent();
}).subscribe();
}

window.addEventListener('beforeunload',()=>{if(realtimeChannel)realtimeChannel.unsubscribe();});
</script>
</body>
</html>
